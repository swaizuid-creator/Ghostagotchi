<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>Ghostagotchi – AI Survival</title>
    <link rel="stylesheet" href="style.css"/>
    <script src="/socket.io/socket.io.js"></script>
</head>
<body>
    <div id="bg-decor"></div>

    <div class="wrap">
        
        <header class="topbar">
            <h1>👻 Ghostagotchi – AI Survival</h1>
            <div class="header-actions">
                <a href="#" class="ghost-btn hype-btn" id="btn-hype">Boost Hype 🚀</a>
                <a href="#" class="ghost-btn gift-btn" id="btn-gift">Gift Ghost 🎁</a> 
                <a href="#" class="ghost-btn" id="btn-share-x">Share on X 📢</a>

                <button id="btn-lore" class="ghost-btn">📖 Lore</button>
                
                <div class="controls">
                    <button id="muteBtn" class="mute">🔇 Sound Off</button>
                    <input id="vol" type="range" min="0" max="100" value="40" title="SFX-volume"/>
                </div>
            </div>
        </header>
        <p class="sub">AI-driven Halloween Tamagotchi. The community "feeds" it via <strong>SOL</strong> volume.</p>
        
        <div class="layout">
            
            <main class="col-main">
                <section class="card head">
                    <div class="avatar-wrap">
                        <div class="avatar-glow"></div>
                        <img id="ghostSprite" src="assets/ghost_idle.png" alt="Ghostagotchi" class="avatar"/>
                        <div id="attentionIcon" class="attention" title="Needs attention" hidden>⚠️</div>
                    </div>
                    <div class="head-right">
                        <div class="row">
                            <div>Name: <strong id="name">Ghostagotchi</strong></div>
                            <div>Mood: <strong id="mood">cheerful</strong> <span id="moodEmoji" class="memoji" aria-hidden="true">🙂</span> </div>
                        </div>
                        <div class="bars three">
                            <label>🍗 Hunger</label><progress id="hunger" max="100" value="75"></progress>
                            <label>⚡ Energy</label><progress id="energy" max="100" value="80"></progress>
                            <label>😊 Happiness</label><progress id="happiness" max="100" value="70"></progress>
                        </div>
                        <div class="last">Last Action: <span id="lastAction">—</span></div>
                        <div class="last" style="margin-top: 8px;">
                            Stage: <strong id="ghostStage">Baby</strong> 
                            <span class="sep">|</span> 
                            Age: <span id="ghostAge">0.00</span> hours
                        </div>
                    </div>
                </section>

                <section class="card community-actions">
                    <div class="action-header">
                        <h2>🗳️ Community Vote (<span id="voteCountdown">02:00</span>)</h2>
                        <small id="lastVoteAction">Laatste actie: —</small>
                    </div>

                    <div class="vote-buttons">
                        <button id="votePlay" class="ghost-btn" data-action="play">⚽️ Speel! (<span id="votesPlay">0</span>)</button>
                        <button id="voteEnergy" class="ghost-btn" data-action="energy">🔋 Geef Energie! (<span id="votesEnergy">0</span>)</button>
                        <button id="voteRest" class="ghost-btn" data-action="rest">😴 Laat Rusten! (<span id="votesRest">0</span>)</button>
                    </div>
                    <p id="voteMessage" style="color:var(--muted); font-size: 0.9em; margin-top: 10px;">
                        Stem op de volgende actie. Je hebt nog niet gestemd in deze ronde.
                    </p>
                </section>

                <section class="card survival">
                    <div class="surv-head">
                        <h2>🫀 Survival Meter (Hourly)</h2>
                        <div class="pair-info">
                            Goal: <strong id="goalUsd">◎0.000</strong>
                            <span class="sep">|</span>
                            Last Hour: <strong id="lastUsd">◎0.000</strong>
                        </div>
                    </div>

                    <div class="progress-wrap jumbo">
                        <div class="progress-bar" id="progressBar"><div id="progressFill"></div></div>
                        <div class="progress-label" id="progressLabel">50%</div>
                    </div>

                    <div class="surv-meta">
                        <p>
                            Status: <strong id="survStatus">Tracking Market</strong>
                            <span class="sep">|</span>
                            Streak: <strong id="streak">0</strong>
                            <span class="sep">|</span>
                            Next Check: <strong id="countdown">00:00</strong>
                        </p>
                        <p>Hype Value: <strong id="hypeValue">50</strong>%</p>
                        <p class="sub next">
                            Next Goal on ✅: <strong id="nextPass">◎0.000</strong>
                            <span class="sep">|</span>
                            on ❌: <strong id="nextFail">◎0.000</strong>
                        </p>
                        <div id="streakBadge" class="streak-badge" hidden>🔥 Streak 1 — We are alive!</div>
                    </div>
                    <small>Survival data gesimuleerd voor demo. Echt volume komt later.</small>
                </section>
                
                <section class="card hype">
                    <h2>🚀 Hype Meter</h2>
                    <div class="hype-bar"><div id="hype-fill" style="width: 50%;"></div></div>
                </section>

                <section class="card cta">
                    <div class="cta-row">
                        <a id="ctaBtn" class="cta-btn" 
                           href="https://ghostagotchi.onrender.com/api/actions/feed-ghost" 
                           target="_blank" 
                           rel="noopener">🟧 Feed the Ghost (SOL Flow)</a>
                        </div>
                </section>

                <div id="callout" class="card callout" hidden>
                    <strong>👻 Ghost is hungry!</strong> We're below 50% goal.
                    <a class="cta-btn inline" id="calloutTrade" href="#" target="_blank" rel="noopener">Feed now</a>
                </div>
            </main>

            <aside class="col-side">
                <section class="card log">
                    <div class="log-header"><h2>📒 Log</h2></div>
                    <ul id="logList">
                        <li>[SYSTEM] Ghostagotchi online. Start survival protocol.</li>
                    </ul>
                </section>
                <footer><small>Entertainment project; no financial promises. © Ghostagotchi</small></footer>
            </aside>
            
        </div>
    </div>
    
    <div id="confettiLayer"></div>
    <div id="toast" class="toast" aria-live="polite"></div>
    <div id="chatBubble" class="bubble" hidden></div>
    
    <div class="card lore-modal" id="loreModal" hidden>
        <h2>📖 Ghostagotchi Lore</h2>
        <p>
            Born from the blockchain shadows, Ghostagotchi drifts through
            wallets and memes. Support, hype and love keep it alive.
        </p>
        <button id="btn-lore-close" class="ghost-btn">Close</button>
    </div>

    <script src="client.js"></script>
</body>
</html>